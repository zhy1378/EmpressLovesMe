
## 一、特殊的庙会

### 1.1. 宣传

### 1.2. 行会

### 1.3. 专利

## 二、宝剑篇

### 2.1. 铸私钱罪犯

熙熙攘攘的人潮中，一条大汉有若鹤立鸡群。他身材高大、相貌堂堂，微微皱眉，仔细观察各种工匠的技艺展示，似乎并不满意。

他叫郭震，字元振，刚从洛阳大理寺刑狱释放，不想跟家人待在一起，却来逛工匠大会。

郭元振十六岁入太学。某次，有仆人给郭元振送来四十万钱，当做学资。有个穿着丧服的人找到他说：“我祖宗五代都没有安葬，希望您能接济我，让我能够办理丧事。”郭元振听后，也不问他姓名，就把四十万钱全部给了他，没有丝毫吝惜。郭元振的同学薛稷、赵彦昭都嘲笑他不通世事，郭元振也不以为意。后来，有人给郭元振送来一封信便立刻离去，信中只有物品清单、没有署名，郭元振便于树下获骡马二十余匹，帛三千匹。郭元振说：“想必是之前那位借钱安葬祖先的人。”薛稷、赵彦昭听说后，皆嗟叹良久。

十八岁中进士后，郭元振担任通泉（本位面四川省射洪县）县尉。他在县公安局长任上，铸造私钱、买卖人口，名声着实不怎么样。

从去年开始，大唐开始发行“圣诞钱”，不仅取消了方孔、质量奇佳，还增加边缘锯齿等防伪措施，大大增加了仿制难度。郭元振建议暂停私铸、发展技术，同党却硬着头皮要试试，果然很快就东窗事发，还牵连到郭元振，被抓进大理寺刑狱。

郭元振的父亲是刺史，家里花了很大气力，四处托情，还缴纳了天量罚金，才让郭元振逃脱惩罚。

郭元振出狱后，并没有变得老老实实。他来逛工匠大会，是想找寻合适的工匠，继续铸私钱大业。

闲逛几圈后，他手里多了几本书：《铜匠入门》、《铁匠入门》、《木匠入门》、《模具入门》等等。他只觉得马户将军非常怪，一方面发行新钱币、提升质量，防止伪造；另一方面将各种技术讲得明明白白。

这几本书又厚又重，都贵的离谱，耗费他二十两白银，富裕如郭元振也颇为肉疼。为了装书，他还买了个“驴包”，也即新式双肩背包，可比老式褡裢好用太多了。

忽然，他在一间屋门前看到一个告示：“招募密码师爷，每月一两银子。”

郭元振好奇地问门口的小伙计：“密码学是什么学问？”

年轻的小伙计两手一摊，说：“客官，俺也不懂，具体介绍您就看上面写的吧。”

### 2.2. 密码学

郭元振抬眼一看，告示上写着：密码学是传递军情所需之学问。因通晓密码学之人太少，现对外传授。任何人都可以免费旁听。只要听得懂，能通过考试，就可以做“密码师爷”，待遇丰厚。

小伙计见郭元振有兴趣，就说：“客官，您进去听吧，不收钱。”

郭元振进到屋里，只见房间很宽阔，摆着几十张桌子，坐了五六十人，一个先生在黑漆木板上用石灰笔写写画画。他找了个空位坐下，桌上摆着一本《密码学入门》，下面还有“不可带出”的警示。

屋里人太多，那先生声音小，郭元振听不大清。他就懒得再听，只低头读那本“密码学入门”。

只翻了一页，他就知道《密码学入门》是老驴手下编撰的。无它，老驴编书，唯恐小民看不懂。不仅用词简朴，加了标点符号，还有大量图画。

坊间早就传言，老驴年轻时是市井泼皮，识字不多。老驴署理马政、工部后，对诸般诘屈聱牙的既有典籍极度不满，便组织大量人手重新编撰。新书编成后，如果不能让凡夫村氓听懂，就是不合格，搞得下属叫苦不迭。这类新编书籍，坊间戏称为“马户新书”。

郭元振也承认，“马户新书”很好用。就他买那几本工匠用书，只翻了翻就颇有助益。郭元振就指望靠这几本书开展自力更生、科技致富的新工作。

### 2.3. 密码本

（脑子生锈的直接跳转 2.5 章节）

最基础的“密码本加密法”，需要一个密码本，用于将汉字编码成数字，一般每个汉字转化为四位数字。这样就可以把一篇文本编码成一串数字。

加密方使用密码本，把军令转变成数字，然后发出。军令即使被截获，但只要敌人没有密码本，就只是拿到了一串毫无意义的数字。解密方使用同个密码本，才能把数字转变成军令。

如果密码本被缴获呢？那就可能彻底泄密。

为了解决密码本泄露问题，一个思路是：不同的军官具有不同的密码本。低级军队可能共用低级密码本，高级军官可能每人都有一个特殊密码本。

汉字数量庞大，编码工作量不低，制作多个密码本也很费劲。于是，在密码本基础上增加了“密钥”。

### 2.4. 密钥

每个人都有独特的密钥，这个密钥既用于加密也用于解密。密钥的用法很简单，将原始数字与密钥对应后，每一位原始数字都要加上对应的密钥，如果数字超过十，就只取个位数，如此循环往复。

比如一串三个汉字编码后是 12 位的 111122224444，密码是 6 位的 123456，那么计算规则就是：

| 编码序号 | 编码数字 | 密钥序号 | 密钥数字 | 结果 | 备注 |
| --- | --- | --- | --- | --- | --- |
|   1  |   1  | 1 | 1 | 2 | 1 + 1 = 2 |
|   2  |   1  | 2 | 2 | 3 | 1 + 2 = 3 |
|   3  |   1  | 3 | 3 | 4 | 1 + 3 = 4 |
|   4  |   1  | 4 | 4 | 5 | 1 + 4 = 5 |
|   5  |   2  | 5 | 5 | 7 | 2 + 5 = 7 |
|   6  |   2  | 6 | 6 | 8 | 2 + 6 = 8 |
|   7  |   2  | 1 | 1 | 3 | 2 + 1 = 3 |
|   8  |   2  | 2 | 2 | 4 | 2 + 2 = 4 |
|   9  |   4  | 3 | 3 | 4 | 4 + 3 = 7 |
|   10  |   4  | 4 | 4 | 5 | 4 + 4 = 8 |
|   11  |   4  | 5 | 5 | 6 | 4 + 5 = 9 |
|   12  |   4  | 6 | 6 | 7 | 4 + 6 = 0，两位数只取个位数 |

经过这一番转换，原始数字 111122224444 就成了 234578347890. 收件人拿到密码信之后，要用同样的规则还原数字，再查密码本获得正确信息。

如果有人截获密信，想要破解，那就要胡乱尝试大量数字。只要密码有六位以上，几乎无法破解。

### 2.5. 击节赞叹

坦白讲，这是个非常原始的密码系统。但在全手工算密码的时代，加密方式稍微复杂点，就得把人累死。

郭元振看了两遍，越看越兴奋。介绍完密码学原理后，《密码学入门》还附加了许多习题。只要能解决这些题目，便可以应聘“密码师爷”。习题都太简单了，扫一眼就全部解出。

他意识到：这套密码学不仅可用于军中，也可用于朝廷机密公文传递。他的犯罪团伙似乎也可以借用这种方式……他越想越兴奋，不禁击节赞叹：妙，妙啊！

这一声吸引来屋内所有人的眼光，正在讲课的先生也停下来看他。郭元振忙道：“我只觉这等手段，真乃绝妙！不觉赞叹出声，是小子失态了。”

那先生不以为忤，便指着黑板问：“这上面的题目，你能解否？”

郭元振一看，都是简单的加减法而已，便随口答出。

先生大喜，问：“你可愿为密码师爷？”他在此教了很多天，大多数学徒脑筋不开窍，密码师爷一直招不够。这位新来的学徒只用了片刻就学会，怎不让他欣喜？

然而郭元振却笑答：“每月一两银，只怕有点低。”

这时，有个仆人到郭元振身边低声问：“我家主人请您去叙谈，可否赏光？”

郭元振只见仆人穿着非常独特且华贵，便问也不问，向先生拱了拱手，随仆人而去。

### 2.6. 宝剑篇

郭元振随仆人出屋，见到一群人众星捧月般围着一人。正中那人比自己还高一寸，相貌举止更是非凡。他大惊，朝中大臣有这般外表的，他只能想到一个人。虽然他强迫自己不要乱看，还是忍不住瞧了一眼那人的裤裆处。还好，那里看起来比较正常。

他心念电转几番，决定冒险一试，便大礼参拜：“小人参见马户将军。”

张秋山微微一愣：“你认得本将军。”

“将军神颜，天下谁人不知。”郭元振保持恭敬姿态，道：“小人自以为容貌尚可，今日见了将军天颜，方知之前不过是‘吾与城北徐公孰美’，贻笑大方而已。”

这一套马屁拍得啪啪响，让张秋山也颇为受用。他说：“平身吧。你学得很快。依你看，这密码学可有用？”

密码学是张秋山得意之作。以他的专业知识，设计密码体系太容易了。最难的部分，是怎么启发杜光清发明密码学，免得暴露自己的数学水平。

“密码学必大行于天下。假设一军被围，如用多人分头送信，如被截获则军情泄露。有了密码，则可用多人同时送信，而不需担心敌军截获后获取情报。也不必担忧被信使拆阅。”

“你可曾从军？”

“投笔从戎，固所愿也，却未有机会。闲暇时分，我也读些兵法，于军旅略有所知。”

“密码师爷一直招不够，却如何是好？”张秋山觉得这套密码体系太简单，普通士人却觉得太难。没办法，他们从小到大只学语文，连算术课都没有。

郭元振建言道：“士子们不习算学，何不找些账房先生？”

“倒也是个办法。”

俩人聊了一会儿，颇为投机。郭元振又问：“如果不使密码学泄露，岂非保密效果更好？”

张秋山答：“真正的好办法，是对手知道你将要做什么，却依然无计可施。”

“将军高见，小人敬服。小人还有些想法……”郭元振给张秋山说了一套思路：大军出征前，各军与总部之间约定好编码本和密钥表。密钥表里包含很多组数字。每次通信都先指定密钥编号，解密方通过密钥表查到密钥，才能解密。

这套办法，老驴早就想到了，从郭元振口中听到还是很吃惊。古人的联想能力不可小觑。就又问：“郭先生家学如何？”

郭元振敏锐地察觉到机会来了，赶紧献上自己最得意的作品：

```
《宝剑篇》
君不见，昆吾铁冶飞炎烟，红光紫气俱赫然。
良工煅炼凡几年，铸得宝剑名龙泉。
龙泉颜色如霜雪，良工咨嗟叹奇绝。
琉璃玉匣吐莲花，错镂金环映明月。
正逢天下无风尘，幸且周防君子身。
精光黯黯青蛇色，文章片片绿龟鳞。
非直结交游侠子，亦曾亲近英雄人。
何言中路遭弃捐，零落漂沦古狱边。
虽则沉埋无所用，犹能夜夜气冲天。
```

“犹能夜夜气冲天，好！好！”马户将军抚掌称赞，然后突然想起了什么：“你就是通泉县尉郭震郭元振？”

“正是小人。”

马户将军眉毛一挑，暗自忖道：靠本事名留青史的人果然各个都有点东西。郭元振没有现代数学基础，只片刻就学会密码算法。还能举一反三，想到密钥的高级用法。历史上，郭元振性格有些“疏狂”，战略判断能力相当强。

“才华横溢，啧……”马户将军一边夸赞，一边皱眉。老驴的疑虑是：郭元振既是名相又是名将，才学毋庸置疑。但郭后来曾担任“右控鹤内供奉”，还当过“奉宸监丞”，只怕跟媚娘也有点不清不楚。

他又打量郭元振一遍，只见他身材魁梧、相貌英俊、三捋长髯，如果媚娘要他和自己夜间共同侍奉……这画面，老驴仅只想一想就遍体恶寒。他有点犹豫地问：“本将军还”

老驴这番表现看在郭元振眼中，却有另一番感受。郭元振知道：“圣诞钱”就是马户将军主持铸造的。自己在通泉县做下的诸般龌蹉事，只怕早已传到马户将军耳中。现在，马户将军看中自己的才能，却对自己的人品颇为犹豫。本朝人物中，马户将军最为炙手可热。搭上这条线，随时可能一飞冲天。

转瞬间，郭元振思虑已毕：既然决定加入“驴党”，那就该表现一下了！他爽朗笑道：“禀告将军，小人在通泉县还有些瓜葛。请将军给我一月，待我将诸般事务料理完毕，便来追随将军。”

## 注释

【1】郭震【真】，字元振，唐朝著名宰相、将领。

【2】杜光清【虚】，工部比较有数学才能的人物。