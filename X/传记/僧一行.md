
张遂（683年-727年），即僧一行，法号敬贤，号大慧禅师，魏州昌乐（今河南省濮阳市南乐县）人，唐代僧人，也称为沙门一行、一行阿阇梨，唐人还呼为“一公”。他是唐代著名的天文学家，风水学家。

张遂自幼天资聪颖、刻苦好学、博览群书．青年时代到长安拜师求学，研究天文和数学，很有成就，成为著名的学者。张遂厌恶飞扬跋扈的官僚，不愿交结武则天的侄儿武三思，又伯遭到迫害，便到河南嵩山做了和尚。张遂精通梵文，熟悉印度的宗教文献，同时了解印度在数学与天文学方面的成就，他的研究充分利用了当时印度的三角学知识。张遂也是佛教密宗的领袖。[1][2]

真言宗将张遂列为传持八祖之一。张遂著有密宗权威著作《大日经疏》。

一行（公元683年～公元727年），佛法名号。中国唐代著名的天文学家和释学家，本名张遂，魏州昌乐（今河南省南乐县）人。[4]

张遂的曾祖是唐太宗李世民的功臣、襄州都督、郯国公张公谨。其父张擅为武功县令。张氏家族在武则天时代已经衰微。张遂自幼生活在关中，刻苦学习历象和阴阳五行之学。青年时代即以学识渊博闻名于长安。为避开武则天侄儿的纠缠，剃度为僧，取名一行。先后在嵩山、天台山、当阳山学习释教经典和天文数学。曾翻译过多种印度佛经，后成为佛教一派——密宗的领袖。[5]

唐朝开元九年（公元721年），因为李淳风的《麟德历》几次预报日食不准，玄宗命一行主持修编新历。一行一生中最主要的成就是编制《大衍历》，他在制造天文仪器、观测天象和主持天文大地测量方面有很大贡献。

幼年时，一行家庭贫困，经常得到邻居王姥姥接济。一行做了天子之师常想起王姥姥。然而尚来不及报答，王姥姥已找上门来。儿子杀人犯罪，王姥姥想让一行出面求求情。一行明白杀人偿命，国法难违。他说：姥姥是一行的恩人，要钱要物要多少一行都应当满足，此事一行却办不到。王姥姥听了大骂一行见死不救忘恩负义。一行惟有不停地在姥姥面前谢罪。目送姥姥离去，一行把一布袋交给两个心腹之人，命他们在指定的一个地方潜藏，他说从中午到黄昏，会有七样东西进入布袋。他们照着做了，用布袋带回七只猪。一行把七只猪放进已准备好的大瓮中封盖。次日一早，宫里来人叩门急切，说皇帝有事相商。刚到便殿，李隆基已迎出来，问：昨夜北斗七星不见了，是吉是凶？如何应对？一行有理有据做了分析，然后建议“莫若大赦天下”。李隆基当即下诏大赦天下。当天晚上，七星中的一颗在天空中出现了，七天后，七星全部在天空中出现了……　恩人的儿子犯死罪，一行要报恩，又要不违犯国法，在此情境下，他惟有用自己的“方法”。段成式记述此事，心中亦有疙瘩解不开：此事颇怪，然大传众口，不得不著之。

僧一行博览无不知，尤善于数，钩深藏往，当时学者莫能测。幼时家贫，邻有王姥，前后济之数十万，及一行开元中承上敬遇，言无不可，常思报之。寻王姥儿犯杀人罪，狱未具，姥访一行求救，一行曰：“姥要金帛，当十倍酬也。明君执法，难以请求，如何？”王姥戟手大骂曰：“何用识此僧！”一行从而谢之，终不顾。一行心计浑天寺中工役数百，乃命空其室内，徙大瓮于中，又密选常住奴二人，授以布囊，谓曰：“某坊某角有废园，汝向中潜伺，从午至昏，当有物入来。其数七，可尽掩之。失一则杖汝。”奴如言而往，至酉后，果有群豕至，奴悉获而归。一行大喜， 令置瓮中，覆以木盖，封于六一泥，朱题梵字数寸，其徒莫测。诘朝，中使叩门急召。至便殿，玄宗迎问曰：“太史奏昨夜北斗不见，是何祥也，师有以禳之乎？”一行曰：“后魏时，失荧惑，至今帝车不见，古所无者，天将大警于陛下也。如臣曲见，莫若大赦天下。”玄宗从之。又，其夕，太史奏北斗一星见，凡七日而复。成式以此事颇怪，然大传众口，不得不著之。

据明正德本《大名府志》及今本《南乐县志》记载：西汉置乐昌县，属东郡。乐昌县在东汉初年废置。西晋于原乐昌县故地复设县，更名昌乐，属魏郡。隋开皇三年(公元583年)，从昌乐县西北部分置繁水县，同属魏州。大业元年(公元605年)，昌乐县并入繁水县。唐贞观十六年(公元643年)，改繁水县为昌乐县。五代后梁贞明二年(公元916年)，昌乐县更名南乐县，仍属魏州。再查考魏州，原名魏郡，北周改之，五代又更名兴唐府、广晋府、大名府。南乐县从五代到民国初年，长期为大名府所辖。由上可见，南乐县是由乐昌、昌乐、繁水沿革而来，唐时的魏州繁水、昌乐即今河南南乐县。

铜人因缘
一行一生有两次与“铜人”相关。

二是高僧一行建造观天仪的两个铜人后铸成三尊铜佛的“商州铜佛龛”遗址仍然留存。

### 王姥姥[6]

《酉阳杂俎》记载： 僧一行博览无不知，尤善于数，钩深藏往，当时学者莫能测。幼时家贫，邻有王姥，前后济之数十万，及一行开元中承上敬遇，言无不可，常思报之。寻王姥儿犯杀人罪，狱未具，姥访一行求救，一行曰：“姥要金帛，当十倍酬也。明君执法，难以请求，如何？”王姥戟手大骂曰：“何用识此僧！”一行从而谢之，终不顾。一行心计浑天寺中工役数百，乃命空其室内，徙大瓮于中，又密选常住奴二人，授以布囊，谓曰：“某坊某角有废园，汝向中潜伺，从午至昏，当有物入来。其数七，可尽掩之。失一则杖汝。”奴如言而往，至酉后，果有群豕至，奴悉获而归。一行大喜，令置瓮中，覆以木盖，封于六一泥，朱题梵字数寸，其徒莫测。诘朝，中使叩门急召。至便殿，玄宗迎问曰：“太史奏昨夜北斗不见，是何祥也，师有以禳之乎？”一行曰：“后魏时，失荧惑，至今帝车不见，古所无者，天将大警于陛下也。如臣曲见，莫若大赦天下。”玄宗从之。又，其夕，太史奏北斗一星见，凡七日而复。成式以此事颇怪，然大传众口，不得不著之。

译文：幼年时，一行家庭贫困，经常得到邻居王姥姥接济。一行做了天子之师常想起王姥姥。然而尚来不及报答，王姥姥已找上门来。儿子杀人犯罪，王姥姥想让一行出面求求情。一行明白杀人偿命，国法难违。他说：姥姥是一行的恩人，要钱要物要多少一行都应当满足，此事一行却办不到。王姥姥听了大骂一行见死不救忘恩负义。一行惟有不停地在姥姥面前谢罪。目送姥姥离去，一行把一布袋交给两个心腹之人，命他们在指定的一个地方潜藏，他说从中午到黄昏，会有七样东西进入布袋。他们照着做了，用布袋带回七只猪。一行把七只猪放进已准备好的大瓮中封盖。次日一早，宫里来人叩门急切，说皇帝有事相商。刚到便殿，李隆基已迎出来，问：昨夜北斗七星不见了，是吉是凶？如何应对？一行有理有据做了分析，然后建议“莫若大赦天下”。李隆基当即下诏大赦天下。当天晚上，七星中的一颗在天空中出现了，七天后，七星全部在天空中出现了……恩人的儿子犯死罪，一行要报恩，又要不违犯国法，在此情境下，他惟有用自己的“方法”。段成式记述此事，心中亦有疙瘩解不开：此事颇怪，然大传众口，不得不著之。

### 佛教地位

对于胎藏界和金刚界两种密法都有继承，而重点弘传胎藏界密法，又在天文历法方面做出突出贡献的密宗传人，是僧中科学家一行。

他自小读书很多，到二十岁左右，已经博览经史，尤其精通阴阳五行之学。他曾写成阐释扬雄《太玄》的专著，名声不小。当时的武三思有意与他结交，但他顾忌其名声不好，便逃走了，正好遇上普寂禅师，就从普寂出家。有一位叫卢鸿的隐士，得知一行的才学，惊异地对普寂说，此子“非君所能教导也，当纵其游学”(《一行传》，《宋高僧传》卷五)。普寂同意一行外出寻访名师高僧，于是他遍访当时的名宿，并曾到浙江天台山国清寺向一位老僧学历法。

一行在京城，一方面参加译经，一方面就是从事他的天文方面的科研工作。《佛祖统纪》说一行“传密教于金刚、无畏”，向这两位传播不同密法的大士学习密法。《佛祖历代通载》卷十三讲到善无畏时，也记一行等人曾参预善无畏的译事。一行参预译《大日经》是在开元十二年(724)，次年写成《大日经疏》，此《疏》，是一行请善无畏阐释《大日经》义，由一行记录并发挥而成的，所以说这部《疏》体现出善无畏和一行的两人思想。据《宋高僧传》，一行又向金刚智学习《陀罗尼印》。金刚智又为一行设坛灌顶，一行还要求金刚智翻译金刚界一系的密法，于是在开元十一年(723)金刚智组织翻译《瑜伽念诵法》、《七俱胝陀罗尼》，一行为笔受。一行又拜不空为师，不空在其《金刚顶经大瑜伽秘密心地法门义诀》中说到，“开元七年，至于西京，一行禅师求我灌顶”。所以，一行的密法兼承胎藏界和金刚界两种，而能融为一体。本来胎藏界之理和金刚界之智也是合而不二的，两者的融合才构成完整的整体。

玄宗请一行进京的主要目的是要他重新制订历法。因为自太初(汉武帝年号)到麟德元年(664)之间，历史上先后有过二十五种历法，但都不精确，玄宗就因为麟德历所标的日蚀总是不准，就诏一行定新历法。一行花了七年的时间，参考了大量的资料，做了许多实测，又制作仪器，以严谨的科学精神，终于写成《大衍历》。又为《大衍历》编制而制造了非常精密的黄道仪。黄道仪仿天的形状而制成圆球形，铜铸，上面标有星宿、赤道及周天的度数，由水力推动其旋转，一日一夜，天转一周。又在天外别置二轮，上面铸有日月，也能转动。以木柜为地，放在木柜子中，天球的一半在柜外，一半在柜中，又做两个木人，分别在木人前置钟鼓，每到一刻就自动击鼓，每至一辰则自动撞钟。这里面使用了齿轮系统。当时都称这一制作为奇妙神功，玄宗下令将它放在武成殿上让百官参观。但后来因为生锈，转不动了，就收藏在集贤院。

一行于开元十五年(727)十月去世，玄宗亲自撰塔铭，谥一行“大慧禅师”号。

一行的著作，以《大日经疏》为其密教思想的代表作，《大衍历》为其历法方面的代表作，这本书是在一行死后的第二年由玄宗诏令编成而正式使用的，称《开元大衍历》，五十二卷。

一行的《大日经疏》把《大日经》中一些隐含的意义都解释出来了，其中对一些教义的阐述，结合了佛教各宗如华严、天台、净土、唯识及儒家的观点，更主要的是该《疏》系统地组织密宗的理论和仪轨，因此对于密宗来讲，本《疏》的地位是十分重要的。

一行认为《大日经》中的第一品《入真言门住心品》是全经之纲，统论全经大意。此品中三句：菩提心为因，大悲为根，方便为究竟，尤为至要。各种功德，皆从心生，所以说菩提心为因。这个心如同虚空。“虚空等心者，即是净菩提”(《大日经疏》卷十九)。所谓大悲为根，根有“执持”的含义，如同树根，执持茎、叶、花、果，使它们不至于倾倒。悲也兼明大慈，应是大慈悲。发起悲愿回向众生，拔除众生一切苦厄。这种大悲心，是从菩提心而生的，“从此净菩提心，而生大悲心也”(同上)。所谓方便究竟，“谓万行圆极，无可复增，应物之权，究尽能事。”(《大日经疏》卷一)是指入真言门的方便法门。一行说这种方便最基本的有三方面，即身密门、语密门、心密门。三密都有其深刻的意义，比如语密门所念的真言，都是“如来妙极之语”。又比如身密门所结身印，“左手是三昧义，右手是般若义，十指是十波罗密满足义”(《大日经疏》卷二)。总此三句，是菩萨得菩提心之后，因一切众生皆有可觉之性而不能自悟，而起大悲心，为众生说方便法，加以救护，使众生得至究竟地。

对于大悲胎藏生曼荼罗，一行加以详尽的诠解。这一曼荼罗，以胎藏为喻，则指修行者最初发菩提心时，犹如父母合因缘，种子之识初入胎中，后来渐渐生长，待出生后，具足种种根体。大悲心也由种子渐渐生起，具足万行。又如婴儿，出生后学习各种技艺，而能施行事业。从净心中生起万行，发起种种方便，济度众生，也是如此。这叫“胞胎胎藏”。以莲花为喻，莲花的种子藏在硬壳中，但在种子中却含藏有莲的枝、叶、花、果的特性。初发的菩提心种子也是如此。种子初生花苞时，莲台和果实等藏于莲叶内，如同出世间心藏在蕴中。莲叶包藏之下，莲花不受风吹雨打，而能日夜生长，犹如大悲胎藏，一旦成就，而能在日光中显照开敷。这层意义叫“莲花胎藏”。

这种胎藏，也称为阿赖耶识，“阿赖耶识，义云‘含藏’。正翻为‘室’，谓诸蕴于此中生，于此中灭，即是诸蕴窠窟，故以为名。”(《大日经疏》卷二)一行又以分别义、因缘义和真实义来分析阿赖耶识。

胎藏曼荼罗的图位，从内到外分三重，中心为第一重，表示佛的菩提自证之德。第二重表示大悲，第三重表示方便。第三重如同各国之君，第二重如同朝廷百官，第一重中，内侍围护垂拱之君，此君为大日如来。

这三重曼荼罗，第一重的中央八叶院，八叶莲花围绕花中的大日如来，大日如来为大曼荼罗王。八叶分别居四佛四菩萨，正东南西北四方之佛，分别表示佛的四智，四菩萨则表示佛的四行。中央院周围，“上方是佛身众德庄严，下方是佛持明使者，皆名如来部门，右方是如来大悲三昧，能滋荣万善，故名莲华部，左方是如来大慧力用，能摧破三障，故名金刚部也”(《大日经疏》卷五)。上方即东方的遍知院，下方即西方的持明院，右方即东方的金刚手院，左方即西方的观音院。第二重包括金刚手院南部的除盖障院，观音院北面的地藏院，持明院西面的虚空藏院，遍知院东面的释迦院。第三重，释迦院东面为文殊院，虚空藏院之西为苏悉地院，除盖障院之南为外金刚部院。

就每一个具体的人而言，一行认为，也都是胎藏曼荼罗，其结构是，“头为内胎，心以上为第一院，脐以上为第二院，脐以下为第三院”(《大日经疏》卷十四)。人的身体，含有三重曼荼罗，从这个意义上讲，众生都有佛性，“众生自心之处，即一切佛大悲胎藏曼荼罗也，所以者何？一切众生，即是华台之藏”(《大日经疏》卷十二)。在此一行提出了“即心是道”的观点，但这还只是显教中大乘教的一般看法，一行更讲即身是佛这个密宗特有的观点，“此悉地之人，不舍此身，不舍此识，而能秘密其身”(《大日经疏》卷十五)。但是，“若即心是道者，何故众生轮回生死，不得成佛？”(《大日经疏》卷一)一行认为，那是因为众生不能“如实知”，不知道自心实相就是菩提，有佛无佛，常自严净，这叫“无明”，叫“无知膜翳”。如果能如实知，就能做到初发心便成正觉，这也是如来藏思想。但虽然其他大乘教中也讲如来藏思想，在一行看来，其成佛的可能性往往是不确定的，“经无数阿僧祗劫，或有成佛，或不成佛者”(同上)。即使成佛，也历时很长。而这真言门，只要按其中的法则修行，就能速证庄严境界，甚至“即同大日如来，亦可致也”(同上)。

至于成佛的一般程序，分为信、入地、五通、二乘、成佛五个过程。信，指“深信如来秘藏，决定不疑；信佛有如是方便，若依行者，必成菩提。”(《大日经疏》卷十五)入地，即指入十地中的第一欢喜地。五通指到第四地后得五通境界。二乘指到第八地得声闻乘和缘觉境。成佛是指从第九地而行菩萨道，到第十地而成佛。成佛之后，“世世受此悉地之果，终不可尽。”(同上)一悟而成永恒。

这种曼荼罗的安立次第，为地、水、火、风、空五者，“先从空中而起风，风上起火，火上起水，水上起地”(《大日经疏》卷十四)。这是世界成立的五大要素，以种子字来表示，即“阿字门为地，缚字门为水，啰字门为火，诃字门为风，佉字门为空”，五者缺一不可，“随阙一缘，终不增长”(《大日经疏》卷一)。这五缘代表色的部分，从本质上讲，万法唯心，这种心，又叫法界，“当知万法唯心，心之实相，即是一切种智，即是诸佛法界，法界即是诸法之体”(《大日经疏》卷七)。这五缘和心缘，构成密宗的六大缘起论。

一行作为科学家，在中国科技史上具有重要的地位，作为佛教高僧，一行传承胎藏和金刚两大部密法，在密宗史上的作用，不只系统组织密教的教义教规，也把两大部融合起来。集科学家与高僧于一身这个特殊身份本身，也说明佛法和科学技术在一定条件下的相融性。

2主要成就

制造黄道游仪

一行主张在实测的基础上编订历法。为此，首先需要有测量天体位置的仪器。他于开元九年（公元721年）率府兵曹参军梁令瓒设计黄道游仪，并制成木模。一行决定用铜铁铸造，于开元十一年（公元723年）完成。这架仪器的黄道不是固定的，可以在赤道上移位，以符合岁差现象（当时认为岁差是黄道沿赤道西退，实则相反）。

制造水运浑天仪

后来，一行和梁令瓒等又设计制造水运浑象。这个以水力推动而运转的浑象，附有报时装置，可以自动报时，称为"水运浑天"或"开元水运浑天俯视图"。

水运浑天仪是一具依靠水力而使其运转，能模仿天体运行的仪器，并可以测定时间。这个浑天仪改进了汉代科学家张衡的设计，注水激轮，令其自转，昼夜一周，除了表现星宿的运动以外，还能表现日升月落，当然比张衡的水运浑象仪更加精巧、复杂了。所以，当水运浑天仪造成之后，置于武成殿前，文武百僚观看后，无不为其制作精妙，测定朔望、报告时辰准确而叹服，共称其妙。

特别是在水运浑天仪上，还设有两个木人（相关的商州铜佛龛文物遗址仍存），用齿轮带动，一个木人每刻（古代把一昼夜分为一百刻）自动击鼓，一个木人每辰（合现在两个小时）自动撞钟。这两个木人是运用机械原理而制成的古代机器人。这是一个十分巧妙的计时机械，是世界上最早的机械时钟装置，是现代机械类钟表的祖先，比公元1370年西方才出现的威克钟要早六个世纪，这充分显示了中国古代劳动人民和科学家的聪明才智。

尽管这架水运浑天仪在使用了一段时间后，便因铜铁渐涩，不能自转而进入博物馆了。但是，一行和梁令瓒却以获得天文钟的发明权而永垂史册。英国著名科技史家李约瑟博士在《中国科学技术史》第四卷中说：高僧一行和梁令瓒所发明的平行联动装置，实质上就是最早的机械时钟，是一切擒纵器的祖先，走在欧洲14世纪第一具机械时钟的前面；

水运浑天仪上刻有二十八宿，注水激轮，每天一周，恰恰与天体周日视运动一致。水运浑天仪一半在水柜里，柜的上框，有如地则自然撞钟。整个水运浑天仪既能演示日、月、星辰的视运动，又能自动报时,有二木人，每刻(古代把一昼夜分做一百刻=0.24小时=14,4分钟)击鼓，每时辰（合现在两小时）撞钟。这是世界上最早将擒纵应用于报时的装置，比外国自鸣钟的出现早了六百多年。

一行等以新制的黄道游仪观测日月五星的运动，测量一些恒星的赤道坐标和对黄道的相对位置，发现这些恒星的位置同汉代所测结果有很大变动。

天文测量

一行受诏改历后组织发起了一次大规模的天文大地测量工作。这次测量，用实测数据彻底地否定了历史上的“日影一寸，地差千里”的错误理论，提供了相当精确的地球子午线一度弧的长度。

一行坐禅
一行坐禅
一行发起这次大规模的天文测量主要目的有二。其一，中国古代有一种传统理论：“日影一寸，地差千里。”刘宋时期的天算家何承天根据当时在交州（今越南河内一带）的测量数据，开始对此提出了怀疑，但长期未能得到证实。隋朝天算家刘焯则提出了用实测结果来否定这一错误说法的具体计划，他说：“交爱之州，表北无影，计无万里，南过戴日，是千里一寸，非其实差。”他建议：“请一水工，并解算术士，取河南北平地之所，可量数百里，南北使正。审时以漏，平地以绳，随气至分，同日度影。得其差率，里即可知。则天地无所匿其形，辰象无所逃其数，超前显圣，效象除疑。”但这个建议在隋朝没有被采纳。一行的测量则实现了这一计划。其二，当时发现，观测地点不同，日食发生的时刻和所见食象都不同，各节气的日影长度和漏刻昼夜分也不相同。这种现象是过去的历法所没有考虑到的。这就需要到各地进行实地测量。

这次测量过程中，由太史监南宫说及太史官大相元太等人分赴各地，“测候日影，回日奏闻”。而一行“则以南北日影较量，用勾股法算之”。可见，一行不仅负责组织领导了这次测量工作，而且亲自承担了测量数据的分析计算工作。

当时测量的范围很广，北到北纬51 度左右的铁勒回纥部（今蒙古乌兰巴托西南），南到约北纬18 度的林邑（今越南的中部）等十三处，超出了现在中国南北的陆地疆界。这样的规模在世界科学史上都是空前的。

其中最值得注意的是由南宫说亲自率领的测量队，按刘焯的计划在黄河两岸平原地区测量的四个点，由北向南有滑州白马（今河南滑县）、汴州浚仪太岳台（今开封西北）、许州扶沟（今河南扶沟）、豫州上蔡武津馆（今河南上蔡）。其中白马在黄河北，其他三点都在黄河以南。它们均介于东经114.2度—114.5 度之间，差不多在同一经度上（即刘焯所说的“南北使正”）。总计白马至上蔡526 里270 步，北极高度相差1.5 度，从而得出大约三百五十一里八十步，北极高度相差一度的结论。这实际上给出了地球子午线一度的长度。

由于对唐尺数值的大小，人们目前的看法还不一致，故评价一行这次子午线测量的精度受到限制。初步的估计结果是，一行的测量值与现代值相比，相对误差大约为11.8%。

国外最早根据日影长度计算地球周长的是古希腊科学家埃拉托斯特尼，约公元前240年，他根据亚历山大港与阿斯旺之间不同的正午时分的太阳高线及三角学计算，以斯塔蒂亚（stadia）为单位出地球的直径。斯塔蒂亚乃是古希腊的长度单位，各地不一。如按雅典的长度算，则地球周长为46620公里，多了16.3%，若按埃及的长度算，则地球周长为39690公里，其误差小于2%。

伊斯兰世界最早的子午线实测是在公元814 年，在一行之后九十年，由天文学家阿尔·花剌子米（约783—850）参与组织，在幼发拉底河平原进行了一次大地测量，测算结果得出子午线一度长为111.815 公里（现代理论值为110.6 公里），相当精确。

制定大衍历

从开元十三年（公元725年）起，一行开始编历。经过两年时间，编成草稿，定名为《大衍历》。《大衍历》后经张说和历官陈玄景等人整理成书。从开元十七年起，根据《大衍历》编算成的每年的历书颁行全国。经过检验，《大衍历》比唐代已有的其他历法都更精密。开元二十一年（公元733年）传入日本，行用近百年。

科学成就

《大衍历》的九服晷影算法及其正切函数表

中国古代历法从东汉《四分历》开始，就有各节气初日晷影长度和太阳去极度的观测记录，漏刻、晷影成为古代历法的重要计算项目。隋朝刘焯发明二次等间距插值法之后，李淳风首先将二次插值法引入到漏刻计算中，由每气初日的漏刻、晷影长度数求该气各日的漏刻、晷影数。但是，各历法中所记载和计算的漏刻和晷影大多是阳城（今河南登封东南告成镇）的数值。一行在编制《大衍历》时，曾进行了大规模的天文测量，通过观测知道，随去极度变化的影长，又因地方而异，但同太阳的天顶距有固定的对应关系。一行在《大衍历》中发明了求任何地方每日影长和去极度的计算方法，称做“九服晷影”。

历法中已给出阳城各气初日的太阳去极度，则各气的去极度差即为已知，同样各气的太阳天顶距差亦为已知，而这个差数对于任一地点都是相等的。这样一来，对于任一地方，只要知道某一节气（如夏至）的太阳天顶距，其他各气的太阳天顶距都可以通过加减这个差数求出。剩下还要解决以下两个问题：其一，如何求某地夏至（或冬至）的太阳天顶距；其二，已知天顶距如何换算出晷影长。这两个问题都可以通过建立一个影长与太阳天顶距的对应数表来解决。

如果列出一张以天顶距为引数，每隔一度的影长的数值表，则以上两个问题都可以解决：先在所测地测出（冬）夏至晷影长度（在一行领导的大地测量中，在每处都进行了这样的测量），由影长查表得出太阳天顶距，再加减一个如前所述的差数即可求出该地各气的天顶距，返回再查表得影长。一行在《大衍历》“步晷漏术”中就建立了这样一个从0 度到80 度的每度影长与太阳天顶距对应数表，这是世界数学史上最早的一张正切函数表。

在国外，大约920 年左右，阿拉伯学者阿尔·巴坦尼（al-Battani，约858年—929年）根据影长与太阳仰角之间的关系，编制了0 度—90 度每隔一度时12 尺竿子的影长表，这实际上是一个12ctgα的数表。另一位阿拉伯学者阿尔·威发（Abul-Wafa，940—998）在980 年左右编成了正切和余切函数表，每隔15 度和10 度给出一个值。他还首次引进了正割和余割函数。一行和阿尔·巴坦尼差不多沿着相同的途径编成正切和余切函数表。一行用太阳天顶距，阿尔·巴坦尼用太阳仰角，两者互为余角，所以他们两人的发现是相同的。而一行的正切函数表比阿尔·巴坦尼的余切函数表早近两百年，比阿尔·威发的正切表要早二百五十年。尽管一行的正切函数表只从0 度到80 度，误差也相应大一些，但它毕竟是世界上最早的正切函数表。

《大衍历》的插值算法

浑天象模拟图
浑天象模拟图
今天常用的牛顿插值公式，其不等间距的形式比等间距的形式要复杂得多。天算史界有一种流行的看法，认为在中国古代，唐朝天文学家、数学家一行在其《大衍历》中发明了二次不等间距插值法，且一行还有意识地应用了三次差内插法近似公式。因此，一行在插值法方面的贡献备受中外天算史研究者的关注。中国古代非线性插值法，是刘焯在其《皇极历》（604年）中考虑到太阳运动不均匀性为计算太阳行度改正值时首创的。有关中国古代插值法的算理研究的新成果表明，刘焯二次等间距插值法的造术原理建立在源于《九章算术》描述匀变速运动的模型基础之上，认为太阳每日的运行速度之值构成一等差数列。质言之，所用数学方法就是构造一等差数列并求其前若干项和。一行的插值法并没有人们所想象那样的推广意义。就插值算法本身，一行算法与刘焯算法实质完全相同。所不同的是，《皇极历》是在以平气为间隔的日躔表基础上插值。而《大衍历》是在以定气为间隔的日躔表上插值。

《太初历》以后，各历都以平分一回归年365.25 日为24 等份而得每节气长15.22 日，这样规定的二十四气称为“常气”，或叫“平气”。张子信指出“日行春分后则迟，秋分后则速”，于是刘焯造《皇极历》时体会到二十四气皆应有“定日”，他说：“春、秋分定日去冬至各八十八日有奇，去夏至各九十三日有奇。”但刘焯并没有搞清楚太阳速度的加减和季节的关系，他的日躔表是把秋分定日后到春分定日前平均分为12 段，每气14.54 日；春分定日后到秋分定日前也平分为12 段，每气15.45 日。这显然不是“定气”。一行则认为，太阳在一回归年365.2444 日中共行365.2444 度，每气行15.2185 度。冬至附近日行速度最急，故二气间所需运行时间最短，夏至附近日行速度最缓，故二气间的时间最长。实际上，《大衍历》这里首先提出了平分黄道为24 等份，以太阳实际走完每个等份的时间长度为各节气长度，这就是通常所称的“定气”概念。一行提出正确的定气概念以后，在计算太阳改正时自然就以定气为插值间隔。至于插值法本身则完全是沿用刘焯的方法。

值得一提的是，刘焯在日躔表中规定太阳视运动一年内的变化规律是：冬至最快，冬至后渐慢，到立春时开始加快，春分时又达到最快，冬至到春分这段时间内日速比平均速度快。春分后太阳视运动的速度突变为最慢，之后逐渐加快，到立夏时又开始减慢，夏至达到最慢。春分到夏至时段内比平均速度慢。夏至以后的变化情况以夏至处为镜面对称。

《大衍历》盈缩分一年内的变化趋势将盈缩分在冬至附近最大，以后逐渐变小，夏至时最小，之后又逐渐增大。这相当于把冬至作为太阳视运动的近日点，夏至为远日点。这种认识是正确的，而《皇极历》的规定是不符合实际的。

说一行有意识地应用了三次差内插法的近似公式，是指《大衍历》的月亮极黄纬算法和五星中心差改正算法中所用的插值法。当对中国古代历法中的插值法的构造原理有了深入的认识之后，研究者进一步通过将这两处插值法的有关术文与刘焯二次等间距插值法的术文进行对比研究，证明两者在实质上也是相同的。

人们之所以会认为《大衍历》使用了三次差插值法，是因为《大衍历》在上述两种算法的插值法中都引入了“中差”概念的缘故。但实际上一行引入“中差”的原因在于，刘焯日躔表中的各气陟降率之差是相等的，而《大衍历》月亮极黄纬等数表相邻两栏的差一般不等。这种现象的出现，正是一行受命改历时作了大量天文观测的结果。若仍照搬《皇极历》的做法，就会出现同一点处有可能得到两个不同的值的现象，这就迫使一行必须在计算方法上进行一点细节上的调整。

3轶事典故编辑
一行

沙门一行，俗姓张名遂，郯公公瑾之曾孙。年少出家，以聪敏学行，见重于代。玄宗诏于光大殿改撰历经。后又移就丽正殿，与学士参校。一行乃撰《开元大衍历》一卷，《历议》十卷，《历成》十二卷，《历书》二十四卷，《七政长历》三卷。凡五部五十卷。未及奏上而卒。张说奏上之，诏令行用。初，一行造黄道游仪以进。御制（制原作进，据《大唐新语》改）《游仪铭》付太史监，将向灵台上，用以测候。分遣太史官大相元太等，驰驿往安南、朗、衮等州，测候日影。同以二分二至之日午时，量日影，皆数年方定。安南极高二十一度六分，冬至日影长七尺九寸三分，春秋二分长二尺九寸三分，夏至日在表南三寸一分，蔚州横野军北极高四十度，冬至日影长一丈五尺八分，春秋二分长六尺六寸二分，夏至影在表北二尺二寸九分。此二所为中土南北之极。朗、衮、太原等州，并差互不同。用勾股法算之云："大约南北极，相去才八万余里。"修历人陈玄景亦善算。叹曰："古人云，'以管窥天，以蠡测海'。以为不可得而致也。今以丈尺之术而测天地之大，岂可得哉？若依此而言，则天地岂得为大也。"其后参校一行《历经》，并精密，迄今行用。（出《大唐新语》）

【译文】

僧人一行，俗姓张名遂，是郯公张公瑾的曾孙。一行和尚从小就出家为僧人，用他自己的聪慧与才智，为当代人所看重。唐玄宗将他召入光大殿改写历书，后来又移住在丽正殿，跟翰林学士们一起检验校核。于是一行和尚撰写成了《开元大衍历》一卷，《历议》十卷、《历成》十二卷、《历书》二十四卷、《七政长历》三卷，一共五部五十卷，未来得及上报给玄宗皇帝他就病逝了。宰相张说将一行和尚的遗著上报给玄宗皇帝后，玄宗下诏书命令使用一行撰写的新历。初时，一行和尚制造了一部黄道游仪进献皇上。玄宗皇帝亲自在上面撰写了《游仪铭》后，交付给太史监，将它放置在观测天象的灵台上，用来测量时辰，并且分别派遣太史官大相、元太等人，乘驿车赶往安南、朗、衮等州，去测量日影。同时在春分、秋分，夏至、冬至这天的午时，测量日影，都测量好几年才定下来。安南州极高二十一度六分，冬至那天日影长七尺九寸二分，春分、秋分长二尺九寸三分，夏至这天日影在表南长三寸一分。蔚州横野军北极高四十度，冬至日影长一丈五尺八分，春分、秋分长六尺六寸二分，夏至日影在表北长二尺二寸九分。这两个地方是中华国土的南极与北极。朗、衮、太原等州，差的各不相同，用勾股法计算，说："大约南北极，相距才八万多里。修历书的人陈玄景也精通算学，感叹地说："古人说，用管来观察天象，用瓢来测量海水，认为是办不到的事情。现在一行僧人用丈、尺为单位来测量天地的大小，怎么可以测量出来呢？若按一行僧的说话，天与地又怎么能称得上大呢？"后来，陈玄景参加检查校核一行僧人撰写的《历经》，使它更加精密，直到现在使用的还是这部《历经》。

僧一行，姓张氏，先名遂，魏州昌乐人，襄州都督、郯国公公谨之孙也。父擅，武功令。

一行少聪敏，博览经史，尤精历象、阴阳、五行之学。时道士尹崇博学先达，素多坟籍。一行诣崇，借扬雄《太玄经》，将归读之。数日，复诣崇，还其书。崇曰：“此书意指稍深，吾寻之积年，尚不能晓，吾子试更研求，何遽见还也？”一行曰：“究其义矣。”因出所撰《大衍玄图》及《义决》一卷以示崇。崇大惊，因与一行谈其奥赜，甚嗟伏之。谓人曰：“此后生颜子也。”一行由是大知名。武三思慕其学行，就请与结交，一行逃匿以避之。寻出家为僧，隐于嵩山，师事沙门普寂。睿宗即位，敕东都留守韦安石以礼征。一行固辞以疾，不应命。后步往荆州当阳山，依沙门悟真以习梵律。

癫坷开元五年，玄宗令其族叔礼部郎中洽赍敕书就荆州强起之。一行至京，置于光太殿，数就之，访以安国抚人之道，言皆切直，无有所隐。开元十年，永穆公主出降，敕有司优厚发遣，依太平公主故事。一行以为高宗末年，唯有一女，所以特加其礼。又太平骄僭，竟以得罪，不应引以为例。上纳其言，遽追敕不行，但依常礼。其谏诤皆此类也。

卷，一行尤明著述，撰《大衍论》三卷，《摄调伏藏》十卷，《天一太一经》及《太一局遁甲经》、《释氏系录》各一卷。时《麟德历经》推步渐疏，敕一行考前代诸家历法，改撰新历，又令率府长史梁令瓒等与工人创造黄道游仪，以考七曜行度，互相证明。于是一行推《周易》大衍之数，立衍以应之，改撰《开元大衍历经》。至十五年卒，年四十五，赐谥曰“大慧禅师”。

魏书初，一行从祖东台舍人太素，撰《后魏书》一百卷，其《天文志》未成，一行续而成之。上为一行制碑文，亲书于石，出内库钱五十万，为起塔于铜人之原。明年，幸温汤，过其塔前，又驻骑徘徊，令品官就塔以告其出豫之意；更赐绢五十匹，以莳塔前松柏焉。

逅拢初，一行求访师资，以穷大衍，至天台山国清寺，见一院，古松十数，门有流水。一行立于门屏间，闻院僧于庭布算声，而谓其徒曰：“今日当有弟子自远求吾算法，已合到门，岂无人导达也？”即除一算。又谓曰：“门前水当却西流，弟子亦至。”一行承其言而趋入，稽首请法，尽受其术焉，而门前水果却西流。道士邢和璞尝谓尹愔曰：“一行其圣人乎？汉之洛下闳造历，云：‘后八百岁当差一日，必有圣人正之。’今年期毕矣，而一行造《大衍》正其差谬，则洛下闳之言，信矣！非圣人而何？

为之时又有黄州僧泓者，善葬法。每行视山原，即为之图，张说深信重之。

说，桑道茂者，大历中游京师，善太一遁甲五行灾异之说，言事无不中。代宗召之禁中，待诏翰林。建中初，神策军修奉天城，道茂请高其垣墙，大为制度，德宗不之省。及朱泚之乱，帝苍卒出幸，至奉天，方思道茂之言。时道茂已卒，命祭之。

赞曰：术数之精，事必前知。粲如垂象，变告无疑。怪诞之夫，诬罔蓍龟。致彼庸妄，幸时艰危。[7]

4史籍记载编辑
一钜鹿

（唐）郑处诲 《明皇杂録》：僧一行，姓张氏，钜鹿人，本名遂。

（宋）释赞宁《宋高僧传》：释一行。俗姓张。钜鹿人也。本名遂则。唐初佐命剡国公公谨之支孙也。

（宋）李昉等《太平广记》：僧一行姓张氏,钜鹿人,本名遂。

钜鹿，今河北省邢台市巨鹿县，唐代开元年间，邢州更名巨鹿郡，巨鹿县隶属之。

二魏州昌乐

（宋代）《旧唐书》载：一行，“魏州昌乐人，襄州都督、郯国公公谨之孙也”。属今河北河南交界地。